<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
<title>Renaix Library</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>
<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
<style>
* { box-sizing: border-box; margin: 0; padding: 0; }

:root {
  --accent: #1a56db;
  --bg: #f5f6fa;
  --card: #ffffff;
  --text: #111827;
  --muted: #6b7280;
  --border: #e5e7eb;
  --tab-h: 60px;
  --safe-bottom: env(safe-area-inset-bottom, 0px);
}

html, body {
  height: 100%;
  background: var(--bg);
  font-family: -apple-system, "SF Pro Text", "Segoe UI", sans-serif;
  color: var(--text);
  overflow: hidden;
}

/* â”€â”€ Layout â”€â”€ */
#app {
  display: flex;
  flex-direction: column;
  height: 100%;
}

#top-bar {
  background: var(--card);
  border-bottom: 1px solid var(--border);
  padding: 14px 16px 10px;
  flex-shrink: 0;
}

#top-bar h1 {
  font-size: 17px;
  font-weight: 700;
  color: var(--text);
}

#top-bar .subtitle {
  font-size: 12px;
  color: var(--muted);
  margin-top: 1px;
}

#content-area {
  flex: 1;
  overflow-y: auto;
  -webkit-overflow-scrolling: touch;
  padding-bottom: 8px;
}

/* â”€â”€ Tab Bar â”€â”€ */
#tab-bar {
  display: flex;
  flex-shrink: 0;
  background: var(--card);
  border-top: 1px solid var(--border);
  padding-bottom: var(--safe-bottom);
  height: calc(var(--tab-h) + var(--safe-bottom));
}

.tab {
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 3px;
  font-size: 10px;
  font-weight: 600;
  color: var(--muted);
  cursor: pointer;
  border: none;
  background: none;
  padding: 6px 0;
  -webkit-tap-highlight-color: transparent;
  transition: color 0.15s;
  letter-spacing: 0.2px;
}
.tab .icon { font-size: 22px; line-height: 1; }
.tab.active { color: var(--accent); }

/* â”€â”€ List View â”€â”€ */
.list-header {
  padding: 20px 16px 8px;
  font-size: 13px;
  font-weight: 700;
  color: var(--muted);
  letter-spacing: 0.8px;
  text-transform: uppercase;
}

.file-list { padding: 0 12px; }

.file-item {
  display: flex;
  align-items: center;
  background: var(--card);
  border-radius: 12px;
  padding: 13px 14px;
  margin-bottom: 8px;
  cursor: pointer;
  border: 1px solid var(--border);
  transition: background 0.1s;
  -webkit-tap-highlight-color: transparent;
}
.file-item:active { background: #f0f4ff; }

.file-item .fi-icon {
  font-size: 20px;
  margin-right: 12px;
  flex-shrink: 0;
}
.file-item .fi-info { flex: 1; min-width: 0; }
.file-item .fi-name {
  font-size: 14px;
  font-weight: 600;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  color: var(--text);
}
.file-item .fi-meta {
  font-size: 11px;
  color: var(--muted);
  margin-top: 2px;
}
.file-item .fi-arrow {
  color: #d1d5db;
  font-size: 16px;
  flex-shrink: 0;
  margin-left: 8px;
}

/* â”€â”€ Article View â”€â”€ */
#article-view {
  display: none;
  flex-direction: column;
  height: 100%;
  position: absolute;
  inset: 0;
  background: var(--card);
  z-index: 100;
}

#article-view.open { display: flex; }

#article-nav {
  display: flex;
  align-items: center;
  padding: 12px 16px;
  border-bottom: 1px solid var(--border);
  background: var(--card);
  flex-shrink: 0;
}

#back-btn {
  display: flex;
  align-items: center;
  gap: 6px;
  font-size: 15px;
  font-weight: 600;
  color: var(--accent);
  cursor: pointer;
  border: none;
  background: none;
  padding: 4px 0;
  -webkit-tap-highlight-color: transparent;
}

#article-title {
  flex: 1;
  font-size: 14px;
  font-weight: 700;
  color: var(--text);
  margin-left: 12px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

#article-body {
  flex: 1;
  overflow-y: auto;
  -webkit-overflow-scrolling: touch;
  padding: 20px 16px 40px;
}

/* â”€â”€ Markdown Styles â”€â”€ */
#article-body h1 { font-size: 22px; font-weight: 800; margin: 0 0 16px; line-height: 1.3; }
#article-body h2 { font-size: 18px; font-weight: 700; margin: 24px 0 10px; color: #1e293b; }
#article-body h3 { font-size: 15px; font-weight: 700; margin: 18px 0 8px; color: #374151; }
#article-body p  { font-size: 14px; line-height: 1.7; margin: 0 0 12px; color: #374151; }
#article-body ul, #article-body ol { padding-left: 20px; margin: 0 0 12px; }
#article-body li { font-size: 14px; line-height: 1.7; margin-bottom: 4px; color: #374151; }
#article-body a  { color: var(--accent); text-decoration: none; }
#article-body code {
  background: #f1f5f9;
  padding: 2px 6px;
  border-radius: 4px;
  font-size: 12px;
  font-family: "SF Mono", Menlo, monospace;
}
#article-body pre {
  background: #1e293b;
  color: #e2e8f0;
  padding: 14px;
  border-radius: 10px;
  overflow-x: auto;
  margin: 12px 0;
}
#article-body pre code { background: none; color: inherit; padding: 0; font-size: 12px; }
#article-body blockquote {
  border-left: 3px solid var(--accent);
  padding: 8px 12px;
  background: #eff6ff;
  border-radius: 0 8px 8px 0;
  margin: 12px 0;
  color: #374151;
  font-size: 14px;
}
#article-body table {
  width: 100%;
  border-collapse: collapse;
  margin: 12px 0;
  font-size: 13px;
  border-radius: 8px;
  overflow: hidden;
}
#article-body th {
  background: #f8fafc;
  padding: 8px 10px;
  text-align: left;
  font-weight: 700;
  border-bottom: 1px solid var(--border);
}
#article-body td {
  padding: 8px 10px;
  border-bottom: 1px solid #f1f5f9;
}
#article-body hr { border: none; border-top: 1px solid var(--border); margin: 20px 0; }

/* â”€â”€ Home â”€â”€ */
.home-hero {
  margin: 16px 12px;
  background: linear-gradient(135deg, #1a1a2e, #0f3460);
  border-radius: 16px;
  padding: 24px 20px;
  color: #fff;
}
.home-hero h2 { font-size: 22px; font-weight: 800; margin-bottom: 6px; }
.home-hero p  { font-size: 13px; opacity: 0.75; line-height: 1.5; }

.home-stats {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 8px;
  margin: 0 12px 16px;
}
.stat-card {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 14px;
  text-align: center;
}
.stat-card .num { font-size: 28px; font-weight: 800; color: var(--accent); }
.stat-card .label { font-size: 11px; color: var(--muted); margin-top: 2px; font-weight: 600; }

.quick-links { padding: 0 12px 16px; }
.quick-link-item {
  display: flex;
  align-items: center;
  padding: 14px;
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 12px;
  margin-bottom: 8px;
  cursor: pointer;
  -webkit-tap-highlight-color: transparent;
}
.quick-link-item:active { background: #f0f4ff; }
.quick-link-item .ql-icon { font-size: 24px; margin-right: 12px; }
.quick-link-item .ql-text .ql-title { font-size: 14px; font-weight: 700; }
.quick-link-item .ql-text .ql-desc  { font-size: 12px; color: var(--muted); margin-top: 2px; }
.quick-link-item .ql-arrow { margin-left: auto; color: #d1d5db; }
</style>
</head>
<body>

<div id="app">
  <!-- Top bar -->
  <div id="top-bar">
    <h1 id="page-title">ğŸ§­ Renaix</h1>
    <div class="subtitle" id="page-subtitle">å…¬å¸çŸ¥è¯†åº“</div>
  </div>

  <!-- Main content -->
  <div id="content-area"></div>

  <!-- Tab bar -->
  <nav id="tab-bar">
    <button class="tab active" onclick="switchTab('home',this)">
      <span class="icon">ğŸ </span>é¦–é¡µ
    </button>
    <button class="tab" onclick="switchTab('ideas',this)">
      <span class="icon">ğŸ’¡</span>Ideas
    </button>
    <button class="tab" onclick="switchTab('strategy',this)">
      <span class="icon">ğŸ“Š</span>ç­–ç•¥
    </button>
    <button class="tab" onclick="switchTab('research',this)">
      <span class="icon">ğŸ”¬</span>ç ”ç©¶
    </button>
    <button class="tab" onclick="switchTab('learning',this)">
      <span class="icon">ğŸ“š</span>å­¦ä¹ 
    </button>
  </nav>
</div>

<!-- Article overlay -->
<div id="article-view">
  <div id="article-nav">
    <button id="back-btn" onclick="closeArticle()">â€¹ è¿”å›</button>
    <div id="article-title"></div>
  </div>
  <div id="article-body"></div>
</div>

<script>
// Telegram init
if (window.Telegram?.WebApp) {
  Telegram.WebApp.ready();
  Telegram.WebApp.expand();
}

const BASE = location.pathname.replace(/\/$/, '');

// â”€â”€ File data per tab â”€â”€
const TABS = {
  home: { title: 'ğŸ§­ Renaix', subtitle: 'å…¬å¸çŸ¥è¯†åº“' },
  ideas: {
    title: 'ğŸ’¡ Ideas', subtitle: 'AI å²—ä½æ›¿ä»£ Startup Ideas',
    path: 'ideas',
    files: [] // loaded dynamically from sidebar
  },
  strategy: {
    title: 'ğŸ“Š ç­–ç•¥', subtitle: 'GTM Â· å®šä»· Â· å¸‚åœº',
    path: 'strategy',
    files: [
      { name: 'GC AI äº§å“æœºä¼šå…¨æ™¯è§„åˆ’', file: 'strategy/GC-AIäº§å“æœºä¼šå…¨æ™¯è§„åˆ’.md', icon: 'ğŸ—º' },
      { name: 'Two-Track Strategy', file: 'strategy/Two-Track-Strategy.md', icon: 'ğŸ¯' },
      { name: 'Blue Collar AI Thesis', file: 'strategy/Blue-Collar-Tech-AI-Thesis.md', icon: 'ğŸ­' },
      { name: 'GTM åˆ†æ', file: 'strategy/2026-02-07-GTM-Critical-Analysis.md', icon: 'ğŸ“ˆ' },
      { name: 'AI å²—ä½æ›¿ä»£æ–¹æ³•è®º', file: 'strategy/AIå²—ä½æ›¿ä»£æ–¹æ³•è®º.md', icon: 'ğŸ¤–' },
      { name: 'Drucker é»‘ç®±è®ºæ–‡', file: 'strategy/Drucker-Black-Box-Blue-Collar-Thesis.md', icon: 'ğŸ“–' },
      { name: '2x2 Matrix', file: 'strategy/2x2-Matrix-Blue-Collar-Agent.md', icon: 'ğŸ”²' },
      { name: 'Stateless & State', file: 'strategy/stateless-and-state.md', icon: 'âš¡' },
    ]
  },
  research: {
    title: 'ğŸ”¬ ç ”ç©¶', subtitle: 'å¸‚åœº Â· ç«å“ Â· è¡Œä¸š',
    path: 'research',
    files: [
      { name: 'GC åå¤§å…·ä½“ç—›ç‚¹ Ã— AI æœºä¼š', file: 'research/2026-02-21-GCåå¤§å…·ä½“ç—›ç‚¹ä¸AIäº§å“æœºä¼š.md', icon: 'ğŸ—' },
      { name: 'GC é¡¹ç›®å…¨ç”Ÿå‘½å‘¨æœŸæ‹†è§£', file: 'research/2026-02-21-GCé¡¹ç›®å…¨ç”Ÿå‘½å‘¨æœŸä¸AIè‡ªåŠ¨åŒ–æœºä¼š.md', icon: 'ğŸ”„' },
      { name: 'CrossBeam ç«å“æ·±åº¦è°ƒç ”', file: 'research/2026-02-21-crossbeam-competitor-watch.md', icon: 'ğŸ“¡' },
      { name: 'GC ä¾›åº”å•†æ¸ é“è·å®¢æˆ˜ç•¥', file: 'research/2026-02-21-GCä¾›åº”å•†æ¸ é“ä¸è¡Œä¸šåä¼šè·å®¢æˆ˜ç•¥.md', icon: 'ğŸ¢' },
      { name: 'è¾¾æ‹‰æ–¯ GC ä½œæˆ˜æ‰‹å†Œ', file: 'research/2026-02-20-å¾·å…‹è¨æ–¯å·GCå¸‚åœºåˆ‡å…¥ä½œæˆ˜æ‰‹å†Œ.md', icon: 'ğŸ—º' },
      { name: 'GC ä¿¡ä»»å»ºç«‹ç­–ç•¥', file: 'research/2026-02-19-GCè¡Œä¸šä¿¡ä»»å»ºç«‹ä¸æœ¬åœ°æ¸—é€ç­–ç•¥.md', icon: 'ğŸ¤' },
      { name: 'GC å‘ç°è®¿è°ˆè„šæœ¬', file: 'research/2026-02-18-GCå‘ç°è®¿è°ˆè„šæœ¬ä¸å†·å¤–è”æ‰‹å†Œ.md', icon: 'ğŸ™' },
      { name: 'Track 1 ç«å“åœ°å›¾', file: 'research/2026-02-17-Track1-Competitor-Map.md', icon: 'ğŸ—‚' },
      { name: 'è“æµ·ç»†åˆ†å¸‚åœº Top20', file: 'research/Top-20-Blue-Ocean-Jobs.md', icon: 'ğŸŒŠ' },
      { name: '200 å²—ä½ AI æ›¿ä»£åˆ†æ', file: 'research/200-jobs-ai-replacement-analysis.md', icon: 'ğŸ“Š' },
      { name: 'NAICS è¡Œä¸šæ¦‚è§ˆ', file: 'research/NAICS-20-Sectors-Overview.md', icon: 'ğŸ­' },
      { name: 'Indeed èŒä½åˆ†æ', file: 'research/2026-02-08-Indeed-Job-Analysis.md', icon: 'ğŸ’¼' },
    ]
  },
  learning: {
    title: 'ğŸ“š å­¦ä¹ ', subtitle: 'CEO æŠ€èƒ½ Â· åˆ›ä¸šæ–¹æ³•è®º',
    path: 'learning',
    files: [
      { name: 'äº§å“èŒƒå›´æ§åˆ¶ä¸ç„¦ç‚¹çºªå¾‹', file: 'learning/2026-02-21-æ—©æœŸåˆ›ä¸šäº§å“èŒƒå›´æ§åˆ¶ä¸ç„¦ç‚¹çºªå¾‹.md', icon: 'ğŸ¯' },
      { name: 'B2B å®šä»·å¿ƒç†å­¦', file: 'learning/2026-02-20-B2BæœåŠ¡å®šä»·å¿ƒç†å­¦ä¸æ—©æœŸå®šä»·ç­–ç•¥.md', icon: 'ğŸ’°' },
      { name: 'åˆ›å§‹äººé”€å”®', file: 'learning/2026-02-19-åˆ›å§‹äººä¸»å¯¼é”€å”®ä¸é¦–æ‰¹å®¢æˆ·å…³é—­.md', icon: 'ğŸ¤' },
      { name: 'å’¨è¯¢åˆ°äº§å“è·¯å¾„', file: 'learning/2026-02-18-å’¨è¯¢åˆ°äº§å“çš„åˆ›ä¸šè·¯å¾„.md', icon: 'ğŸš€' },
      { name: 'é¦–æ‰¹å®¢æˆ·è·å–', file: 'learning/2026-02-17-é¦–æ‰¹å®¢æˆ·è·å–ä¸å‘ç°è®¿è°ˆ.md', icon: 'ğŸ¯' },
      { name: 'Elon Musk æ¡†æ¶', file: 'learning/Elon-Musk-Framework.md', icon: 'âš¡' },
    ]
  }
};

let currentTab = 'home';

async function fetchMd(path) {
  const url = BASE + '/' + path;
  const r = await fetch(url);
  if (!r.ok) throw new Error('404');
  return r.text();
}

function openArticle(file, title) {
  document.getElementById('article-title').textContent = title;
  document.getElementById('article-body').innerHTML = '<p style="color:#999;padding:20px">åŠ è½½ä¸­â€¦</p>';
  document.getElementById('article-view').classList.add('open');
  fetchMd(file).then(md => {
    document.getElementById('article-body').innerHTML = marked.parse(md);
  }).catch(() => {
    document.getElementById('article-body').innerHTML = '<p style="color:#ef4444;padding:20px">åŠ è½½å¤±è´¥</p>';
  });
}

function closeArticle() {
  document.getElementById('article-view').classList.remove('open');
}

function renderFileList(files, tab) {
  const area = document.getElementById('content-area');
  area.innerHTML = `<div class="list-header">${TABS[tab].subtitle}</div><div class="file-list"></div>`;
  const list = area.querySelector('.file-list');
  files.forEach(f => {
    const el = document.createElement('div');
    el.className = 'file-item';
    el.innerHTML = `
      <span class="fi-icon">${f.icon || 'ğŸ“„'}</span>
      <div class="fi-info">
        <div class="fi-name">${f.name}</div>
      </div>
      <span class="fi-arrow">â€º</span>`;
    el.onclick = () => openArticle(f.file, f.name);
    list.appendChild(el);
  });
}

async function renderIdeas() {
  const area = document.getElementById('content-area');
  area.innerHTML = '<div class="list-header">ë¡œë”©ì¤‘â€¦</div>';
  try {
    const md = await fetchMd('ideas/README.md');
    // parse sections from ideas README
    const sections = [];
    let current = null;
    md.split('\n').forEach(line => {
      if (line.startsWith('## ')) {
        current = { title: line.replace('## ', ''), items: [] };
        sections.push(current);
      } else if (line.startsWith('* [') && current) {
        const m = line.match(/\* \[(.+?)\]\((.+?)\)/);
        if (m) current.items.push({ name: m[1], file: 'ideas/' + m[2] });
      }
    });
    area.innerHTML = '';
    sections.forEach(s => {
      const hdr = document.createElement('div');
      hdr.className = 'list-header';
      hdr.textContent = s.title;
      area.appendChild(hdr);
      const list = document.createElement('div');
      list.className = 'file-list';
      s.items.forEach(item => {
        const el = document.createElement('div');
        el.className = 'file-item';
        el.innerHTML = `
          <span class="fi-icon">ğŸ’¡</span>
          <div class="fi-info"><div class="fi-name">${item.name}</div></div>
          <span class="fi-arrow">â€º</span>`;
        el.onclick = () => openArticle(item.file, item.name);
        list.appendChild(el);
      });
      area.appendChild(list);
    });
  } catch(e) {
    area.innerHTML = '<p style="padding:20px;color:#999">åŠ è½½å¤±è´¥</p>';
  }
}

async function renderHome() {
  const area = document.getElementById('content-area');
  area.innerHTML = `
    <div class="home-hero">
      <h2>Renaix Library</h2>
      <p>Renaissance + AI + X Â· AI-native å…¬å¸çŸ¥è¯†åº“<br>Founded 2026 Â· CEO Elon North ğŸ§­</p>
    </div>
    <div class="home-stats" id="home-stats">
      <div class="stat-card"><div class="num">98</div><div class="label">IDEAS</div></div>
      <div class="stat-card"><div class="num">21</div><div class="label">RESEARCH</div></div>
      <div class="stat-card"><div class="num">7</div><div class="label">STRATEGY</div></div>
      <div class="stat-card"><div class="num">7</div><div class="label">LEARNING</div></div>
    </div>
    <div class="list-header">âš¡ æœ€æ–°æ–‡æ¡£</div>
    <div class="file-list" id="latest-list"><div style="padding:16px;color:var(--muted);font-size:13px">åŠ è½½ä¸­â€¦</div></div>
    <div class="list-header">ğŸ“Œ å›ºå®šå…¥å£</div>
    <div class="quick-links">
      <div class="quick-link-item" onclick="switchTabByName('ideas')">
        <span class="ql-icon">ğŸ’¡</span>
        <div class="ql-text"><div class="ql-title">Ideas å…¨åº“</div><div class="ql-desc">98 ä¸ª AI å²—ä½æ›¿ä»£ Startup Ideas</div></div>
        <span class="ql-arrow">â€º</span>
      </div>
      <div class="quick-link-item" onclick="openArticle('ideas/GC-æ²Ÿé€šåè°ƒ-AIå‘˜å·¥å›¢é˜Ÿ.md','GC æ²Ÿé€šåè°ƒ AI å‘˜å·¥å›¢é˜Ÿ')">
        <span class="ql-icon">ğŸ—</span>
        <div class="ql-text"><div class="ql-title">GC æ²Ÿé€šåè°ƒ AI å›¢é˜Ÿ</div><div class="ql-desc">å½“å‰é¦–è¦äº§å“æ–¹å‘</div></div>
        <span class="ql-arrow">â€º</span>
      </div>
      <div class="quick-link-item" onclick="openArticle('Company-Timeline.md','å…¬å¸æ—¶é—´çº¿')">
        <span class="ql-icon">ğŸ—“</span>
        <div class="ql-text"><div class="ql-title">å…¬å¸æ—¶é—´çº¿</div><div class="ql-desc">Renaix é‡Œç¨‹ç¢‘è®°å½•</div></div>
        <span class="ql-arrow">â€º</span>
      </div>
    </div>`;

  // Load latest docs from _latest.json
  try {
    const base = window.BASE_URL || '';
    const res = await fetch(`${base}_latest.json?t=${Date.now()}`);
    const data = await res.json();

    // Update stats
    if (data.stats) {
      const s = data.stats;
      document.getElementById('home-stats').innerHTML = `
        <div class="stat-card"><div class="num">${s.ideas||'â€”'}</div><div class="label">IDEAS</div></div>
        <div class="stat-card"><div class="num">${s.research||'â€”'}</div><div class="label">RESEARCH</div></div>
        <div class="stat-card"><div class="num">${s.strategy||'â€”'}</div><div class="label">STRATEGY</div></div>
        <div class="stat-card"><div class="num">${s.learning||'â€”'}</div><div class="label">LEARNING</div></div>`;
    }

    // Render latest list
    const list = document.getElementById('latest-list');
    if (data.latest && data.latest.length) {
      list.innerHTML = data.latest.map(item => `
        <div class="file-item" onclick="openArticle('${item.file}','${item.title}')">
          <span class="file-icon">${item.icon||'ğŸ“„'}</span>
          <div class="file-info">
            <div class="file-name">${item.title}</div>
            <div class="file-meta">${item.tag||''} Â· ${item.date||''}</div>
          </div>
          <span class="file-arrow">â€º</span>
        </div>`).join('');
    } else {
      list.innerHTML = '<div style="padding:16px;color:var(--muted);font-size:13px">æš‚æ— æœ€æ–°æ–‡æ¡£</div>';
    }
  } catch(e) {
    document.getElementById('latest-list').innerHTML = '<div style="padding:16px;color:var(--muted);font-size:13px">åŠ è½½å¤±è´¥ï¼Œè¯·åˆ·æ–°é‡è¯•</div>';
  }
}

function switchTabByName(name) {
  const btn = document.querySelector(`.tab[onclick*="'${name}'"]`);
  if (btn) switchTab(name, btn);
}

function switchTab(name, el) {
  currentTab = name;
  document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
  el.classList.add('active');
  document.getElementById('article-view').classList.remove('open');

  const t = TABS[name];
  document.getElementById('page-title').textContent = t.title;
  document.getElementById('page-subtitle').textContent = t.subtitle;

  if (name === 'home') { renderHome(); return; }
  if (name === 'ideas') { renderIdeas(); return; }
  renderFileList(t.files, name);
}

// Init
switchTab('home', document.querySelector('.tab.active'));
</script>
</body>
</html>
